<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–°–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á</title>
  <style>
          body {
        margin: 0;
        font-family: Arial, sans-serif;
        line-height: 1.6;
      }

      header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px 20px;
        background-color: #333;
        color: white;
        position: sticky; /* –§–∏–∫—Å–∞—Ü–∏—è —à–∞–ø–∫–∏ –ø—Ä–∏ –ø—Ä–æ–∫—Ä—É—Ç–∫–µ */
        top: 0; /* –ù–∞—á–∞–ª–æ —Ñ–∏–∫—Å–∞—Ü–∏–∏ –æ—Ç –≤–µ—Ä—Ö–Ω–µ–π –≥—Ä–∞–Ω–∏—Ü—ã –æ–∫–Ω–∞ */
        z-index: 1000; /* –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è */
      }

      .logo {
        font-size: 1.5rem;
        font-weight: bold;
      }

      .navigation {
        position: relative;
      }
      
      .menu {
        display: flex;
        gap: 20px;
        list-style: none;
        margin: 0;
        padding: 0;
      }
      
      .menu li a {
        text-decoration: none;
        color: white;
        padding: 5px 10px;
        border-radius: 5px;
        transition: background-color 0.3s;
      }
      
      .menu li a:hover {
        background-color: #555;
      }

      .menu li a.active {
        background-color: #91d788;
        pointer-events: none;
      }

      .burger-menu {
        display: none;
        flex-direction: column;
        justify-content: space-between;
        width: 30px;
        height: 20px;
        background: none;
        border: none;
        cursor: pointer;
      }
      
      .burger-menu span {
        display: block;
        width: 100%;
        height: 3px;
        background-color: white;
      }

      .burger-menu span {
        display: block;
        width: 100%;
        height: 3px;
        background-color: white;
      }

      .burger-menu.active {
        background: none;
        flex-direction: row;
        justify-content: center;
      }

      .burger-menu.active span {
        display: none;
      }

      .burger-menu.active::before {
        content: "‚úñ"; /* –°–∏–º–≤–æ–ª –∫—Ä–µ—Å—Ç–∏–∫–∞ */
        font-size: 0.5rem;
        color: white;
      }
      
      main {
        padding: 20px;
      }
      
      .columns {
        display: flex;
        justify-content: space-between;
        gap: 20px;
      }
      
      .column {
        flex: 1;
        background: #f5f5f5;
        border-radius: 5px;
        padding: 10px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      }
      
      .task-list {
        margin-top: 10px;
      }
      
      .task {
        background: white;
        padding: 10px;
        margin-bottom: 10px;
        border-radius: 5px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      }
      
      button {
        background: #6fb47c;
        color: white;
        border: none;
        border-radius: 3px;
        padding: 5px 10px;
        cursor: pointer;
      }
      
      button:hover {
        background: #7de497;
      }
      
      .add-task-button {
        margin-bottom: 20px;
        background: #6fb47c;
        color: white;
        border: none;
        border-radius: 3px;
        padding: 5px 10px;
        cursor: pointer;
      }

      .info-button {
        background: #ccc;
        color: black;
        border: none;
        border-radius: 50%;
        width: 25px;
        height: 25px;
        font-size: 16px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        margin-right: 10px;
      }
      
      .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        justify-content: center;
        align-items: center;
      }
      
      .modal-content {
        background: white;
        padding: 20px;
        border-radius: 5px;
        text-align: center;
      }
      
      .close-button {
        float: right;
        font-size: 20px;
        cursor: pointer;
      }

      /* –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è –≤–µ—Ä—Å—Ç–∫–∞ */
      @media (max-width: 768px) {
        .menu {
            height: 100vh;
            width: 100vw;
            display: none;
            flex-direction: column;
            position: fixed;
            top: 7%;
            left: 0;
            background-color: #333;
            padding: 10px;
            border-radius: 5px;
          } 
        
          .menu.active {
            display: flex;
          }
        
          .burger-menu {
            display: flex;
          }

          /* –ö–æ–ª–æ–Ω–∫–∏ –≤ –∫–æ–ª–æ–Ω–∫—É */
          .columns {
            flex-direction: column;
            gap: 10px;
          }
      }
      
      @media (max-width: 480px) {
        .hero {
          flex-direction: column;
          text-align: center;
        }
      
        .hero-text, .hero-image {
          flex: 1;
        }

        /* –ö–æ–ª–æ–Ω–∫–∏ –≤ –∫–æ–ª–æ–Ω–∫—É (–¥–ª—è –º–µ–Ω—å—à–∏—Ö —ç–∫—Ä–∞–Ω–æ–≤) */
        .columns {
          flex-direction: column;
          gap: 5px;
        }
      }

      #addTaskButton {
        background: #6fb47c;
        color: white;
        border: none;
        border-radius: 3px;
        padding: 5px 10px;
        cursor: pointer;
      }
  </style>
</head>
<body>
  <script src="bundle.js"></script>
  <header>
    <div class="logo">
      <img src="../images/logo.svg" alt="logo">
    </div>
    <nav class="navigation">
      <ul class="menu">
        <li><a href="./index.html">–ì–ª–∞–≤–Ω–∞—è</a></li>
        <li><a href="./projects.html">–ü—Ä–æ–µ–∫—Ç—ã</a></li>
        <li><a class="active" href="#">–°–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á</a></li>
        <li><a href="./about.html">–û –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏</a></li>
      </ul>
      <button class="burger-menu" aria-label="–û—Ç–∫—Ä—ã—Ç—å –º–µ–Ω—é">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </nav>
  </header>
  <main>
    <h1>Todo List</h1>
    <button class="add-task-button">–î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É</button>
    
    <div class="columns">
      <div class="column">
        <h2>–ó–∞–¥–∞—á–∏</h2>
        <div id="todoTasks" class="task-list"></div>
      </div>
      <div class="column">
        <h2>–í —Ä–∞–±–æ—Ç–µ</h2>
        <div id="inProgressTasks" class="task-list"></div>
      </div>
      <div class="column">
        <h2>–í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ</h2>
        <div id="doneTasks" class="task-list"></div>
      </div>
    </div>
  </main>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ -->
  <div id="taskModal" class="modal">
    <div class="modal-content">
      <span class="close-button">&times;</span>
      <h2>–î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É</h2>
      <input type="text" id="taskInput" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –∑–∞–¥–∞—á–∏">
      <button id="addTaskButton">–î–æ–±–∞–≤–∏—Ç—å</button>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ -->
  <div id="commentsModal" class="modal">
    <div class="modal-content" style="width: 50%; height: 80%; display: flex; flex-direction: row;">
      <div style="flex: 1; border-right: 1px solid #ccc; padding: 10px; overflow-y: auto;">
        <h3>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</h3>
        <div id="commentsList"></div>
      </div>
      <div style="flex: 1; padding: 10px;">
        <h3>–î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</h3>
        <textarea id="commentInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π" style="width: 100%; height: 70%;"></textarea>
        <button id="addCommentButton" style="margin-top: 10px;">–î–æ–±–∞–≤–∏—Ç—å</button>
      </div>
      <span class="close-button" id="closeCommentsModal" style="position: absolute; top: 10px; right: 20px; cursor: pointer;">&times;</span>
    </div>
  </div>

  <script>
        // –•—Ä–∞–Ω–∏–ª–∏—â–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
        let commentsStorage = JSON.parse(localStorage.getItem('comments')) || {};

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        function loadComments() {
          commentsStorage = JSON.parse(localStorage.getItem('comments')) || {};
        }

        // –û—Ç–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
        function openCommentsModal(taskId) {
          document.getElementById('commentsModal').style.display = 'flex';
          renderComments(taskId);
          document.getElementById('addCommentButton').onclick = () => addComment(taskId);
        }

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –æ–±–ª–∞—Å—Ç–∏ –æ–∫–Ω–∞
        document.getElementById('commentsModal').addEventListener('click', (event) => {
          if (event.target === document.getElementById('commentsModal')) {
            document.getElementById('commentsModal').style.display = 'none';
          }
        });

        // –†–µ–Ω–¥–µ—Ä –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
        function renderComments(taskId) {
          const commentsList = document.getElementById('commentsList');
          commentsList.innerHTML = '';
          const comments = commentsStorage[taskId] || [];
          comments.forEach((comment, index) => {
            const commentDiv = document.createElement('div');
            commentDiv.textContent = `${index + 1}. ${comment}`;
            commentDiv.style.marginBottom = '10px';
            commentsList.appendChild(commentDiv);
          });
        }

        // –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
        function addComment(taskId) {
          const commentInput = document.getElementById('commentInput');
          const commentText = commentInput.value.trim();
          if (!commentText) return;

          if (!commentsStorage[taskId]) {
            commentsStorage[taskId] = [];
          }
          commentsStorage[taskId].push(commentText);
          localStorage.setItem('comments', JSON.stringify(commentsStorage));
          commentInput.value = '';
          renderComments(taskId);
        }

        // ----------------

        let todoTasks = [];
        let inProgressTasks = [];
        let doneTasks = [];

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á –≤ localStorage
        function saveTasks() {
          localStorage.setItem('todoTasks', JSON.stringify(todoTasks));
          localStorage.setItem('inProgressTasks', JSON.stringify(inProgressTasks));
          localStorage.setItem('doneTasks', JSON.stringify(doneTasks));
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–¥–∞—á –∏–∑ localStorage
        function loadTasks() {
          todoTasks = JSON.parse(localStorage.getItem('todoTasks')) || [];
          inProgressTasks = JSON.parse(localStorage.getItem('inProgressTasks')) || [];
          doneTasks = JSON.parse(localStorage.getItem('doneTasks')) || [];
        }

        document.querySelector('.add-task-button').addEventListener('click', () => {
          document.getElementById('taskModal').style.display = 'flex';
        });

        document.querySelector('.close-button').addEventListener('click', () => {
          document.getElementById('taskModal').style.display = 'none';
        });

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ –æ–±–ª–∞—Å—Ç–∏
        document.getElementById('taskModal').addEventListener('click', (event) => {
          if (event.target === document.getElementById('taskModal')) {
            document.getElementById('taskModal').style.display = 'none';
          }
        });

        document.getElementById('addTaskButton').addEventListener('click', () => {
          const taskText = document.getElementById('taskInput').value;
          if (taskText.trim()) {
            todoTasks.push(taskText);
            saveTasks(); // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á
            document.getElementById('taskInput').value = '';
            document.getElementById('taskModal').style.display = 'none';
            renderTasks();
          }
        });

        function renderTasks() {
          const todoColumn = document.getElementById('todoTasks');
          const inProgressColumn = document.getElementById('inProgressTasks');
          const doneColumn = document.getElementById('doneTasks');

          todoColumn.innerHTML = '';
          todoTasks.forEach((task, index) => {
            todoColumn.innerHTML += `
              <div class="task">
                <button class="info-button" onclick="openCommentsModal('todo-${index}')">üí¨</button>
                <span>${task}</span>
                <div>
                  <button onclick="moveToInProgress(${index})">–í —Ä–∞–±–æ—Ç—É</button>
                  <button onclick="deleteTask(${index}, 'todo')">–£–¥–∞–ª–∏—Ç—å</button>
                </div>
              </div>`;
          });

          inProgressColumn.innerHTML = '';
          inProgressTasks.forEach((task, index) => {
            inProgressColumn.innerHTML += `
              <div class="task">
                <button class="info-button" onclick="openCommentsModal('inProgress-${index}')">üí¨</button>
                <span>${task}</span>
                <div>
                  <button onclick="markAsDone(${index})">–í—ã–ø–æ–ª–Ω–µ–Ω–æ</button>
                  <button onclick="deleteTask(${index}, 'inProgress')">–£–¥–∞–ª–∏—Ç—å</button>
                </div>
              </div>`;
          });

          doneColumn.innerHTML = '';
          doneTasks.forEach((task, index) => {
            doneColumn.innerHTML += `
              <div class="task">
                <button class="info-button" onclick="openCommentsModal('done-${index}')">üí¨</button>
                <span>${task}</span>
                <button onclick="deleteTask(${index}, 'done')">–£–¥–∞–ª–∏—Ç—å</button>
              </div>`;
          });
        }

        function moveToInProgress(index) {
          const task = todoTasks[index];
          const taskId = `todo-${index}`;
          inProgressTasks.push(task);
          todoTasks.splice(index, 1);

          // –ü–µ—Ä–µ–Ω–æ—Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
          commentsStorage[`inProgress-${inProgressTasks.length - 1}`] = commentsStorage[taskId] || [];
          delete commentsStorage[taskId];
          localStorage.setItem('comments', JSON.stringify(commentsStorage));

          saveTasks();
          renderTasks();
        }

        function markAsDone(index) {
          const task = inProgressTasks[index];
          const taskId = `inProgress-${index}`;
          doneTasks.push(task);
          inProgressTasks.splice(index, 1);

          // –ü–µ—Ä–µ–Ω–æ—Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
          commentsStorage[`done-${doneTasks.length - 1}`] = commentsStorage[taskId] || [];
          delete commentsStorage[taskId];
          localStorage.setItem('comments', JSON.stringify(commentsStorage));

          saveTasks();
          renderTasks();
        }

        function deleteTask(index, column) {
          if (column === 'todo') {
            todoTasks.splice(index, 1);
          } else if (column === 'inProgress') {
            inProgressTasks.splice(index, 1);
          } else if (column === 'done') {
            doneTasks.splice(index, 1);
          }
          saveTasks();
          renderTasks();
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        loadTasks();
        loadComments();
        renderTasks();
  </script>
</body>
</html>